<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <meta name="description" content="Shop Key Game - Mua key game gi√° r·∫ª">
  <title>Shop Key Game</title>
  <link rel="icon" type="image/png"
    href="https://anhdephd.vn/wp-content/uploads/2022/04/anh-avatar-gau-cam-chiec-dep-600x600.jpg">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <!-- SweetAlert2 CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

  <style>
    :root {
      --primary-color: #adf590;
      /* Xanh l√° c√¢y nh·∫°t */
      --secondary-color: #8b5cf6;
      /* T√≠m */
      --bg-dark: #afbcd9;
      /* N·ªÅn ch√≠nh, m√†u xanh x√°m */
      --card-bg: #f3f3ea;
      /* N·ªÅn th·∫ª/container, m√†u kem nh·∫°t */
      --input-bg: #ededed;
      /* N·ªÅn input, m√†u x√°m nh·∫°t */
      --text-color: #3b3b3b;
      /* M√†u ch·ªØ ch√≠nh, x√°m ƒë·∫≠m */
      --border-radius: 12px;
      /* Bo g√≥c chung */
      --shadow-color-dark: rgba(50, 50, 93, 0.25);
      --shadow-color-light: rgba(0, 0, 0, 0.3);
    }

    body {
      background-image: url('https://hoanghamobile.com/tin-tuc/wp-content/uploads/2023/09/hinh-nen-lien-quan.jpg');
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      background-attachment: fixed;
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      color: var(--text-color);
      /* ƒê·∫£m b·∫£o m√†u ch·ªØ m·∫∑c ƒë·ªãnh cho body */
    }

    .container {
      box-shadow: var(--shadow-color-dark) 0px 50px 100px -20px, var(--shadow-color-light) 0px 30px 60px -30px;
      max-width: 800px;
      margin: 30px auto;
      padding: 30px;
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      animation: fadeInDown 0.5s ease;
      position: relative;
      z-index: 1;
    }

    h3 {
      text-align: center;
      font-weight: 800;
      margin-bottom: 30px;
      color: var(--text-color);
    }

    .form-label {
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--text-color);
      /* ƒê·∫£m b·∫£o m√†u ch·ªØ cho label */
    }

    .form-select,
    .form-control {
      background-color: var(--input-bg);
      color: var(--text-color);
      border: 1px solid #64748b;
      transition: all 0.3s;
      padding: 10px 15px;
      border-radius: 8px;
      /* Th√™m bo g√≥c cho input/select */
    }

    .form-select:focus,
    .form-control:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 0.25rem rgba(173, 245, 144, 0.25);
    }

    .btn-warning {
      background: linear-gradient(to right, #d8b59c, #c9c7be);
      border: none;
      font-weight: bold;
      color: black;
      padding: 10px 25px;
      border-radius: var(--border-radius);
      transition: all 0.3s;
    }

    .btn-warning:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4);
    }

    .btn-primary {
      background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
      border: none;
      font-weight: bold;
      border-radius: var(--border-radius);
      transition: all 0.3s;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(139, 92, 246, 0.4);
    }

    /* Modal styles */
    .modal {
      position: fixed;
      z-index: 1050;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      outline: 0;
      display: none;
      /* Bootstrap handles this */
    }

    .modal.show {
      display: block;
      /* Bootstrap handles this */
    }

    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1040;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
      background-color: var(--card-bg);
      box-shadow: var(--shadow-color-dark) 0px 50px 100px -20px, var(--shadow-color-light) 0px 30px 60px -30px;
      color: var(--text-color);
      border-radius: var(--border-radius);
    }

    .modal-header {
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      /* ƒêi·ªÅu ch·ªânh m√†u border */
      color: var(--text-color);
    }

    .modal-header .btn-close {
      filter: invert(0.5);
      /* ƒê·∫£o m√†u n√∫t ƒë√≥ng ƒë·ªÉ d·ªÖ nh√¨n tr√™n n·ªÅn s√°ng */
    }

    .modal-footer {
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      /* ƒêi·ªÅu ch·ªânh m√†u border */
    }

    /* Style cho QR Code Container */
    #qrCodeContainer {
      border: 3px solid var(--primary-color);
      border-radius: var(--border-radius);
      padding: 10px;
      max-width: 220px;
      /* Gi·ªõi h·∫°n k√≠ch th∆∞·ªõc container QR */
      height: auto;
      display: block;
      margin: 0 auto;
      background-color: #fff;
      /* N·ªÅn tr·∫Øng cho QR code */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    /* ƒê·∫£m b·∫£o h√¨nh ·∫£nh/canvas b√™n trong QR Code Container kh√¥ng tr√†n ra ngo√†i */
    #qrCodeContainer canvas,
    #qrCodeContainer img {
      max-width: 100%;
      height: auto;
      display: block;
    }


    .copy-btn {
      margin-left: 10px;
      font-size: 14px;
      background-color: #22c55e;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 8px;
      transition: all 0.2s;
    }

    .copy-btn:hover {
      background-color: #16a34a;
      transform: scale(1.05);
    }

    /* Styles for hide/show key functionality */
    .key-info-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      flex-wrap: wrap;
      /* Cho ph√©p xu·ªëng d√≤ng tr√™n mobile */
    }

    .key-info-row p {
      margin-bottom: 0;
      margin-right: 10px;
      display: flex;
      align-items: center;
      color: var(--text-color);
    }

    .key-display-wrapper {
      flex-grow: 1;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
      min-width: 120px;
      /* ƒê·∫£m b·∫£o ƒë·ªß kh√¥ng gian cho placeholder */
      margin-right: 10px;
    }

    .key-display-wrapper span {
      font-weight: 600;
      color: var(--text-color);
      transition: filter 0.3s ease, color 0.3s ease;
      display: inline-block;
    }

    .key-display-wrapper span.hidden-key {
      filter: blur(4px);
      /* L√†m m·ªù nh·∫π h∆°n ƒë·ªÉ ph√π h·ª£p v·ªõi n·ªÅn s√°ng */
      color: #888;
      /* M√†u x√°m khi ·∫©n */
      user-select: none;
      cursor: pointer;
    }

    .key-display-wrapper span.revealed-key {
      filter: blur(0px);
      color: var(--text-color);
      user-select: all;
      cursor: text;
    }

    .key-actions {
      display: flex;
      align-items: center;
      gap: 5px;
      /* Kho·∫£ng c√°ch gi·ªØa n√∫t m·∫Øt v√† n√∫t copy */
      flex-shrink: 0;
    }

    .toggle-visibility {
      background-color: var(--input-bg);
      color: var(--text-color);
      border: 1px solid #ccc;
      padding: 5px 8px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: inline-flex;
      /* ƒê·ªÉ cƒÉn gi·ªØa icon */
      align-items: center;
      justify-content: center;
    }

    .toggle-visibility:hover {
      background-color: #e0e0e0;
      color: var(--primary-color);
      border-color: var(--primary-color);
    }

    .games-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .game-card {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      transition: all 0.3s;
    }

    .game-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
    }

    .game-image {
      width: 100%;
      height: 180px;
      object-fit: cover;
    }

    .game-content {
      padding: 15px;
    }

    .game-title {
      margin: 0 0 10px;
      font-size: 18px;
      font-weight: 600;
      color: var(--text-color);
    }

    .game-btn {
      display: block;
      width: 100%;
      margin-bottom: 8px;
      text-align: center;
    }

    @media (max-width: 768px) {
      .container {
        max-width: 95%;
        padding: 20px;
      }

      .games-container {
        grid-template-columns: 1fr;
      }

      .key-info-row {
        flex-direction: column;
        /* X·∫øp d·ªçc c√°c ph·∫ßn t·ª≠ */
        align-items: flex-start;
        /* CƒÉn tr√°i */
      }

      .key-info-row p {
        margin-bottom: 5px;
        margin-right: 0;
      }

      .key-display-wrapper {
        width: 100%;
        margin-right: 0;
        margin-bottom: 10px;
      }

      .key-actions {
        width: 100%;
        justify-content: flex-start;
        /* CƒÉn tr√°i c√°c n√∫t */
      }
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.03);
      }

      100% {
        transform: scale(1);
      }
    }

    /* SweetAlert2 Custom Styles */
    .custom-swal-popup {
      background-color: var(--card-bg) !important;
      color: var(--text-color) !important;
      border-radius: var(--border-radius) !important;
      box-shadow: var(--shadow-color-dark) 0px 50px 100px -20px, var(--shadow-color-light) 0px 30px 60px -30px !important;
      border: 1px solid rgba(0, 0, 0, 0.1) !important;
    }

    .custom-swal-title {
      color: var(--primary-color) !important;
      font-size: 1.8rem !important;
      font-weight: 600 !important;
    }

    .custom-swal-text {
      color: var(--text-color) !important;
      font-size: 1.1rem !important;
      margin-top: 10px !important;
    }

    .custom-swal-button {
      background-color: var(--primary-color) !important;
      color: var(--text-color) !important;
      border-radius: 8px !important;
      font-size: 1.1rem !important;
      padding: 10px 20px !important;
      transition: background-color 0.2s ease, transform 0.2s ease !important;
      border: none !important;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2) !important;
    }

    .custom-swal-button:hover {
      background-color: var(--secondary-color) !important;
      transform: translateY(-2px) !important;
      box-shadow: 0 7px 20px rgba(0, 0, 0, 0.3) !important;
    }

    .custom-swal-button:active {
      transform: translateY(0) !important;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2) !important;
    }
  </style>
</head>

<body>
  <div class="container">
    <h3 class="text-center mb-4">
      <i class="fa-solid fa-gamepad me-2"></i>SHOP KEY GAME<i class="fa-solid fa-gamepad ms-2"></i>
    </h3>
    <form id="orderForm">
      <div class="mb-3">
        <label class="form-label"><i class="fa-solid fa-shop me-2"></i>Game b·∫°n mu·ªën mua</label>
        <select class="form-select" id="game" required>
          <option value="">--- Ch·ªçn Game ---</option>
          <option value="Li√™n Qu√¢n Mobile">Li√™n Qu√¢n Mobile</option>
          <option value="PUBG Mobile">PUBG Mobile</option>
          <option value="Free Fire">Free Fire</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label"><i class="fa-solid fa-clock me-2"></i>Ch·ªçn th·ªùi h·∫°n</label>
        <select class="form-select" id="duration" required>
          <option value="">--- Ch·ªçn th·ªùi gian ---</option>
          <option value="1day">1 ng√†y - 2.000ƒë</option>
          <option value="7day">7 ng√†y - 40.000ƒë</option>
          <option value="30day">30 ng√†y - 100.000ƒë</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label"><i class="fa-solid fa-gift me-2"></i>M√£ gi·∫£m gi√° (n·∫øu c√≥)</label>
        <input type="text" class="form-control" id="discountCode" placeholder="Nh·∫≠p m√£ gi·∫£m gi√°...">
      </div>
      <div class="mb-4 text-center">
        <button type="button" class="btn btn-warning" id="paymentButton">Ti·∫øp t·ª•c thanh to√°n</button>
      </div>

      <div class="modal fade" id="paymentModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title"><i class="fa-solid fa-address-card me-2"></i>Th√¥ng tin thanh
                to√°n</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
            </div>
            <div class="modal-body">
              <p><strong>üë§ Ch·ªß TK:</strong> DAO XUAN KHANH</p>
              <p><strong><i class="fa-solid fa-building-user me-2"></i>Ng√¢n h√†ng:</strong> MB Bank</p>

              <!-- STK row - Removed hide/show and copy functionality -->
              <p><strong><i class="fa-solid fa-address-card me-2"></i>STK:</strong>
                <span id="stk">075020699999</span>
              </p>

              <!-- N·ªôi dung row with hide/show and copy -->
              <div class="key-info-row">
                <p><strong><i class="fa-solid fa-note-sticky me-2"></i>N·ªôi dung:</strong></p>
                <span class="key-display-wrapper">
                  <span id="note" class="hidden-key">********************</span>
                </span>
                <span class="key-actions">
                  <button type="button" class="toggle-visibility" data-target-id="note">
                    <i class="fa-solid fa-eye"></i>
                  </button>
                  <button type="button" class="copy-btn btn btn-sm btn-success" data-target-id="note">
                    <i class="fa-solid fa-clipboard"></i> Copy
                  </button>
                </span>
              </div>

              <p><strong><i class="fa-solid fa-coins me-2"></i>S·ªë ti·ªÅn:</strong> <span id="amount">--</span></p>
              <p><strong><i class="fa-solid fa-cart-shopping me-2"></i>S·∫£n ph·∫©m:</strong> <span id="product">--</span>
              </p>

              <div class="text-center my-3">
                <!-- Changed img to div for qrcode.js -->
                <div id="qrCodeContainer"></div>
              </div>

              <div class="d-grid gap-2">
                <a href="#" class="btn btn-success" id="paymentLink">
                  <i class="fa-solid fa-money-bill-wave me-2"></i>M·ªü trang thanh to√°n
                </a>
                <button type="button" class="btn btn-primary" id="confirmBtn">
                  <i class="fa-solid fa-check me-2"></i>T√¥i ƒë√£ thanh to√°n
                </button>
              </div>

              <div id="resultBox" class="mt-3"></div>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>

  <div class="games-container" id="gameList"></div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- qrcode.js library -->
  <script src="https://cdn.jsdelivr.net/npm/davidshimjs-qrcodejs@0.0.2/qrcode.min.js"></script>
  <script>
    // Bi·∫øn to√†n c·ª•c ƒë·ªÉ l∆∞u tr·ªØ key th·ª±c t·∫ø
    let actualStk = '075020699999'; // Gi√° tr·ªã STK m·∫∑c ƒë·ªãnh
    let actualNote = 'NAP1000'; // Gi√° tr·ªã N·ªôi dung m·∫∑c ƒë·ªãnh, s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t

    // H√†m ƒë·ªÉ b·∫≠t/t·∫Øt hi·ªÉn th·ªã key (ch·ªâ d√πng cho 'note' b√¢y gi·ªù)
    function toggleVisibility(elementId) {
      const element = document.getElementById(elementId);
      const toggleButton = document.querySelector(`.toggle-visibility[data-target-id="${elementId}"]`);
      const isHidden = element.classList.contains('hidden-key');

      if (isHidden) {
        element.textContent = actualNote; // Ch·ªâ c√≥ 'note' s·ª≠ d·ª•ng
        element.classList.remove('hidden-key');
        element.classList.add('revealed-key');
        toggleButton.innerHTML = '<i class="fa-solid fa-eye-slash"></i>'; // Icon m·∫Øt b·ªã g·∫°ch
      } else {
        element.textContent = '********************';
        element.classList.remove('revealed-key');
        element.classList.add('hidden-key');
        toggleButton.innerHTML = '<i class="fa-solid fa-eye"></i>'; // Icon m·∫Øt m·ªü
      }
    }

    // H√†m x·ª≠ l√Ω sao ch√©p
    function copyText(textToCopy, elementId) {
      if (!textToCopy || textToCopy.includes('ƒêang t·∫£i...') || textToCopy.includes('L·ªói')) {
        Swal.fire({
          icon: 'warning',
          title: 'Ch∆∞a s·∫µn s√†ng!',
          text: 'N·ªôi dung ch∆∞a s·∫µn s√†ng ƒë·ªÉ sao ch√©p. Vui l√≤ng th·ª≠ l·∫°i.',
          confirmButtonText: 'ƒê√£ hi·ªÉu',
          customClass: {
            popup: 'custom-swal-popup',
            title: 'custom-swal-title',
            htmlContainer: 'custom-swal-text',
            confirmButton: 'custom-swal-button'
          },
          buttonsStyling: false
        });
        return;
      }

      // Th·ª≠ d√πng Clipboard API hi·ªán ƒë·∫°i
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(textToCopy)
          .then(() => {
            Swal.fire({
              icon: 'success',
              title: 'ƒê√£ sao ch√©p!',
              text: 'N·ªôi dung ƒë√£ ƒë∆∞·ª£c sao ch√©p v√†o clipboard.',
              showConfirmButton: false,
              timer: 1500,
              customClass: {
                popup: 'custom-swal-popup',
                title: 'custom-swal-title',
                htmlContainer: 'custom-swal-text',
                confirmButton: 'custom-swal-button'
              },
              buttonsStyling: false
            });
            // T·ª± ƒë·ªông hi·ªÉn th·ªã n·∫øu ƒëang ·∫©n v√† l√† 'note'
            if (elementId === 'note') {
              const element = document.getElementById(elementId);
              if (element && element.classList.contains('hidden-key')) {
                toggleVisibility(elementId);
              }
            }
          })
          .catch(err => {
            console.error('L·ªói sao ch√©p (Clipboard API):', err);
            fallbackCopyText(textToCopy, elementId); // D√πng c√°ch d·ª± ph√≤ng n·∫øu l·ªói
          });
      } else {
        // C√°ch d·ª± ph√≤ng cho tr√¨nh duy·ªát c≈© h∆°n
        fallbackCopyText(textToCopy, elementId);
      }
    }

    // H√†m sao ch√©p d·ª± ph√≤ng
    function fallbackCopyText(textToCopy, elementId) {
      const tempInput = document.createElement('textarea');
      tempInput.value = textToCopy;
      document.body.appendChild(tempInput);
      tempInput.select();
      try {
        document.execCommand('copy');
        Swal.fire({
          icon: 'success',
          title: 'ƒê√£ sao ch√©p!',
          text: 'N·ªôi dung ƒë√£ ƒë∆∞·ª£c sao ch√©p v√†o clipboard (ph∆∞∆°ng ph√°p d·ª± ph√≤ng).',
          showConfirmButton: false,
          timer: 1500,
          customClass: {
            popup: 'custom-swal-popup',
            title: 'custom-swal-title',
            htmlContainer: 'custom-swal-text',
            confirmButton: 'custom-swal-button'
          },
          buttonsStyling: false
        });
        // T·ª± ƒë·ªông hi·ªÉn th·ªã n·∫øu ƒëang ·∫©n v√† l√† 'note'
        if (elementId === 'note') {
          const element = document.getElementById(elementId);
          if (element && element.classList.contains('hidden-key')) {
            toggleVisibility(elementId);
          }
        }
      } catch (err) {
        console.error('L·ªói sao ch√©p (Fallback):', err);
        Swal.fire({
          icon: 'error',
          title: 'L·ªói sao ch√©p!',
          text: 'Kh√¥ng th·ªÉ sao ch√©p t·ª± ƒë·ªông. Vui l√≤ng sao ch√©p th·ªß c√¥ng.',
          confirmButtonText: 'ƒê√£ hi·ªÉu',
          customClass: {
            popup: 'custom-swal-popup',
            title: 'custom-swal-title',
            htmlContainer: 'custom-swal-text',
            confirmButton: 'custom-swal-button'
          },
          buttonsStyling: false
        });
      } finally {
        document.body.removeChild(tempInput);
      }
    }

    // Event listeners cho c√°c n√∫t copy v√† n√∫t b·∫≠t/t·∫Øt hi·ªÉn th·ªã
    document.addEventListener('click', function (event) {
      // X·ª≠ l√Ω n√∫t copy (ch·ªâ 'note' c√≥ data-target-id)
      if (event.target.closest('.copy-btn')) {
        const button = event.target.closest('.copy-btn');
        const targetId = button.dataset.targetId;
        let textToCopy = '';

        // N·∫øu l√† n√∫t copy c·ªßa 'note'
        if (targetId === 'note') {
          textToCopy = actualNote;
        }
        // N·∫øu l√† n√∫t copy tƒ©nh kh√°c (v√≠ d·ª•, n·∫øu c√≥ n√∫t copy cho STK m√† kh√¥ng c√≥ toggle)
        else if (button.dataset.text) {
          textToCopy = button.dataset.text; // L·∫•y text t·ª´ data-text attribute
        }
        copyText(textToCopy, targetId);
      }

      // X·ª≠ l√Ω n√∫t b·∫≠t/t·∫Øt hi·ªÉn th·ªã (ch·ªâ 'note' c√≥ data-target-id)
      if (event.target.closest('.toggle-visibility')) {
        const button = event.target.closest('.toggle-visibility');
        const targetId = button.dataset.targetId;
        if (targetId === 'note') { // ƒê·∫£m b·∫£o ch·ªâ x·ª≠ l√Ω cho 'note'
          toggleVisibility(targetId);
        }
      }
    });

    // Kh·ªüi t·∫°o Bootstrap Modal
    const paymentModal = new bootstrap.Modal(document.getElementById('paymentModal'), {
      keyboard: false
    });

    // L·∫Øng nghe s·ª± ki·ªán modal ƒë∆∞·ª£c hi·ªÉn th·ªã
    document.getElementById('paymentModal').addEventListener('shown.bs.modal', function () {
      // ƒê·∫£m b·∫£o N·ªôi dung ƒë∆∞·ª£c ·∫©n khi modal m·ªü
      const noteElement = document.getElementById('note');
      const toggleNoteBtn = document.querySelector('.toggle-visibility[data-target-id="note"]');

      if (noteElement) {
        noteElement.textContent = '********************';
        noteElement.classList.add('hidden-key');
        noteElement.classList.remove('revealed-key');
      }
      if (toggleNoteBtn) {
        toggleNoteBtn.innerHTML = '<i class="fa-solid fa-eye"></i>';
        toggleNoteBtn.style.display = 'inline-flex'; // Hi·ªÉn th·ªã n√∫t m·∫Øt cho n·ªôi dung
      }
    });

    // Logic hi·ªán c√≥ cho n√∫t thanh to√°n v√† t·∫°o m√£ QR
    document.getElementById('paymentButton').addEventListener('click', function () {
      const game = document.getElementById('game').value;
      const duration = document.getElementById('duration').value;
      const discountCode = document.getElementById('discountCode').value;

      if (!game || !duration) {
        Swal.fire({
          icon: 'error',
          title: 'L·ªói!',
          text: 'Vui l√≤ng ch·ªçn Game v√† Th·ªùi h·∫°n.',
          confirmButtonText: 'ƒê√£ hi·ªÉu',
          customClass: {
            popup: 'custom-swal-popup',
            title: 'custom-swal-title',
            htmlContainer: 'custom-swal-text',
            confirmButton: 'custom-swal-button'
          },
          buttonsStyling: false
        });
        return;
      }

      let amount = 0;
      let productText = "";
      switch (duration) {
        case '1day':
          amount = 2000;
          productText = `${game} - 1 ng√†y`;
          break;
        case '7day':
          amount = 40000;
          productText = `${game} - 7 ng√†y`;
          break;
        case '30day':
          amount = 100000;
          productText = `${game} - 30 ng√†y`;
          break;
      }

      // √Åp d·ª•ng m√£ gi·∫£m gi√° (v√≠ d·ª•)
      if (discountCode === 'KHANHDEV') {
        amount *= 0.9; // Gi·∫£m 10%
        Swal.fire({
          icon: 'success',
          title: '√Åp d·ª•ng m√£ gi·∫£m gi√°!',
          text: 'M√£ KHANHDEV ƒë√£ ƒë∆∞·ª£c √°p d·ª•ng (gi·∫£m 10%).',
          showConfirmButton: false,
          timer: 2000,
          customClass: {
            popup: 'custom-swal-popup',
            title: 'custom-swal-title',
            htmlContainer: 'custom-swal-text',
            confirmButton: 'custom-swal-button'
          },
          buttonsStyling: false
        });
      }

      const orderCode = generateOrderCode(game, duration); // T·∫°o m√£ ƒë∆°n h√†ng duy nh·∫•t
      actualNote = orderCode; // C·∫≠p nh·∫≠t bi·∫øn actualNote v·ªõi m√£ m·ªõi

      document.getElementById('amount').textContent = `${amount.toLocaleString('vi-VN')}ƒë`;
      document.getElementById('product').textContent = productText;

      // ƒê·∫∑t l·∫°i text c·ªßa N·ªôi dung v·ªÅ placeholder v√† ·∫©n n√≥
      const noteElement = document.getElementById('note');
      const toggleNoteBtn = document.querySelector('.toggle-visibility[data-target-id="note"]');

      if (noteElement) {
        noteElement.textContent = '********************';
        noteElement.classList.add('hidden-key');
        noteElement.classList.remove('revealed-key');
      }
      if (toggleNoteBtn) {
        toggleNoteBtn.innerHTML = '<i class="fa-solid fa-eye"></i>';
        toggleNoteBtn.style.display = 'inline-flex'; // Hi·ªÉn th·ªã n√∫t m·∫Øt cho n·ªôi dung
      }

      // T·∫°o m√£ QR b·∫±ng qrcode.js v·ªõi ƒë·ªãnh d·∫°ng URL chuy·ªÉn kho·∫£n
      // S·ª≠ d·ª•ng ƒë·ªãnh d·∫°ng URL chuy·ªÉn kho·∫£n c·ªßa MBBank ƒë·ªÉ QR code h·ª£p l·ªá h∆°n
      const qrText = `https://mb.com.vn/transfer?stk=${actualStk}&amount=${amount}&content=${encodeURIComponent(actualNote)}`;
      const qrCodeContainer = document.getElementById('qrCodeContainer');
      qrCodeContainer.innerHTML = ''; // X√≥a QR c≈© n·∫øu c√≥

      new QRCode(qrCodeContainer, {
        text: qrText,
        width: 200,
        height: 200,
        colorDark: "#3b3b3b", // M√†u t·ª´ --text-color
        colorLight: "#f3f3ea", // M√†u t·ª´ --card-bg
        correctLevel: QRCode.CorrectLevel.H
      });

      // C·∫≠p nh·∫≠t link thanh to√°n (v√≠ d·ª•, thay th·∫ø b·∫±ng link c·ªïng thanh to√°n th·ª±c t·∫ø)
      // document.getElementById('paymentLink').href = `https://mbbank.com.vn/transfer?stk=${actualStk}&amount=${amount}&content=${encodeURIComponent(actualNote)}`;

      paymentModal.show(); // Hi·ªÉn th·ªã modal
    });

    function generateOrderCode(game, duration) {
      const timestamp = Date.now().toString().slice(-6); // 6 ch·ªØ s·ªë cu·ªëi c·ªßa timestamp
      const gamePrefix = game.substring(0, 3).toUpperCase();
      const durationPrefix = duration.substring(0, 2).toUpperCase();
      return `ORDER_${gamePrefix}_${durationPrefix}_${timestamp}`;
    }

    document.getElementById('confirmBtn').addEventListener('click', function () {
      Swal.fire({
        icon: 'success',
        title: 'Thanh to√°n ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n!',
        text: 'Vui l√≤ng ƒë·ª£i trong gi√¢y l√°t ƒë·ªÉ h·ªá th·ªëng ki·ªÉm tra, baÃ£n vui loÃÄng li√™n h√™Ã£ admin.',
        confirmButtonText: 'ƒê√≥ng',
        customClass: {
          popup: 'custom-swal-popup',
          title: 'custom-swal-title',
          htmlContainer: 'custom-swal-text',
          confirmButton: 'custom-swal-button'
        },
        buttonsStyling: false
      }).then(() => {
        paymentModal.hide(); // ƒê√≥ng Bootstrap modal sau khi x√°c nh·∫≠n
        // T·∫°i ƒë√¢y b·∫°n th∆∞·ªùng s·∫Ω k√≠ch ho·∫°t qu√° tr√¨nh x√°c minh ·ªü backend
      });
    });

    // Kh·ªüi t·∫°o tr·∫°ng th√°i ·∫©n cho N·ªôi dung khi trang t·∫£i
    document.addEventListener('DOMContentLoaded', () => {
      const noteElement = document.getElementById('note');
      const toggleNoteBtn = document.querySelector('.toggle-visibility[data-target-id="note"]');

      // ·∫®n n·ªôi dung v√† hi·ªÉn th·ªã placeholder
      if (noteElement) {
        noteElement.textContent = '********************';
        noteElement.classList.add('hidden-key');
        noteElement.classList.remove('revealed-key');
      }
      // ·∫®n n√∫t m·∫Øt ban ƒë·∫ßu cho N·ªôi dung (ch·ªâ hi·ªán khi modal ƒë∆∞·ª£c m·ªü v√† c√≥ d·ªØ li·ªáu)
      if (toggleNoteBtn) {
        toggleNoteBtn.innerHTML = '<i class="fa-solid fa-eye"></i>'; // ƒê·∫£m b·∫£o icon ƒë√∫ng
        toggleNoteBtn.style.display = 'none'; // ·∫®n n√∫t m·∫Øt cho n·ªôi dung khi trang t·∫£i
      }
    });
  </script>
</body>

</html>
